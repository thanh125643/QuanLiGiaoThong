CREATE DATABASE QLGT
GO
USE QLGT
GO

CREATE TABLE USERS
(
	ID INT IDENTITY(1,1),
	USERID NVARCHAR(20) NOT NULL,
	USERNAME NVARCHAR(20) NOT NULL,
	MK NVARCHAR(20) NOT NULL,
	HOTEN NVARCHAR(50) NOT NULL,
	SDT VARCHAR(20) NOT NULL UNIQUE check(SDT like'[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]' or SDT like'[0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9][0-9]'),
	CMND NVARCHAR(20) UNIQUE NOT NULL,
	DIACHI NVARCHAR(80) NOT NULL,
	LOAI INT,
	CONSTRAINT PK_USERS PRIMARY KEY (USERID)

)
select * from THONGTINCHECK
INSERT INTO USERS(USERID,USERNAME,MK,HOTEN,SDT,CMND,DIACHI,LOAI) VALUES ('09092020051001','PHAT','admin','Long Vĩnh Phát','0903170626','TH12312','136,Nguyễn Tiểu La,P5,Q10',0),
							('09032020051002','Misaka','123','Bùi Ca','0903896123','LH13212','232,Nguyễn Tri Phương,P5,Q10',1),
							('28032020051001','nguyen','1','Khoi Nguyen','0903896124','LH13213','178,Le Duan,P07,Q05',1),
							('28032020051002','phong','2','Ngoc Phong','0903896126','LH13214','22,Nguyen Thi Thap,P05,Q10',1),
							('28032020051003','truc','3','Xuan truc','0903896177','LH13215','32,Nuyen Lam,P08,Q12',2),
							('28032020051004','tuan','0','Minh tuan','0903896000','LH13000','194/11,Tan Phu,P11,Q01',2),
							('28032020051017','a','4','Minh tuan','0903896191','LH13217','194/11,Tan Phu,P11,Q01',1),
							('28032020051005','b','5','Minh tuan','0903896192','LH13218','194/11,Tan Phu,P11,Q02',1),
							('28032020051006','c','6','Minh tuan','0903896193','LH13219','194/11,Tan Phu,P11,Q03',1),
							('28032020051007','d','7','Minh tuan','0903896194','LH13210','194/11,Tan Phu,P11,Q04',1),
							('28032020051008','e','8','Minh tuan','0903896195','LH13222','194/11,Tan Phu,P11,Q06',1),
							('28032020051009','f','9','Minh tuan','0903896196','LH13223','194/11,Tan Phu,P11,Q07',1),
							('28032020051010','h','10','Minh tuan','0903896197','LH13224','194/11,Tan Phu,P11,Q08',1),
							('28032020051011','j','11','Minh tuan','0903896198','LH13225','194/11,Tan Phu,P11,Q09',1),
							('28032020051012','k','12','Minh tuan','0903896199','LH13226','194/11,Tan Phu,P11,Q11',1),
							('28032020051013','l','13','Minh tuan','0903896110','LH13227','194/11,Tan Phu,P11,Q12',1),
							('28032020051014','i','14','Minh tuan','0903896111','LH13228','194/11,Tan Phu,P11,Q13',1),
							('28032020051015','o','15','Minh tuan','0903896112','LH13200','194/11,Tan Phu,P11,Q14',1),
							('28032020051016','p','16','Minh tuan','0903896113','LH13206','194/11,Tan Phu,P11,Q15',1);



CREATE TABLE THONGTIN
(
	ID INT IDENTITY(1,1),
	INFORMID NVARCHAR(20) NOT NULL,
	USERID NVARCHAR(20) NOT NULL,
	INFORMCONTENT NVARCHAR(500) NOT NULL,
	PLACE NVARCHAR(50) NOT NULL,
	SONGUOILQ INT,
	THOIGIAN DATE,
	CONSTRAINT PK_IDINFORM PRIMARY KEY (INFORMID),
	CONSTRAINT FK_USER FOREIGN KEY(USERID) REFERENCES USERS(USERID)
	ON DELETE CASCADE
	ON UPDATE CASCADE
)
INSERT INTO THONGTIN(INFORMID,USERID,INFORMCONTENT,PLACE,SONGUOILQ,THOIGIAN) VALUES('09032020001','28032020051003','dasdasdsadsadasdasdasdasdasdasdasdas','131 nguyen tri phuong,P05,Q10',12,'2018-10-20'),
('09032020002','28032020051003','dasdasdsadsadasdasdasdasdasdasdasdas','131 nguyen tri phuong,P05,Q11',12,'2018-10-20'),
('09032020003','28032020051003','dasdasdsadsadasdasdasdasdasdasdasdas','131 nguyen tri phuong,P05,Q06',12,'2018-10-20'),
('09032020004','28032020051004','dasdasdsadsadasdasdasdasdasdasdasdas','131 nguyen tri phuong,P05,Q05',12,'2018-10-20'),
('09032020005','28032020051004','dasdasdsadsadasdasdasdasdasdasdasdas','131 nguyen tri phuong,P05,Q02',12,'2018-10-20'),
('09032020006','28032020051004','dasdasdsadsadasdasdasdasdasdasdasdas','131 nguyen tri phuong,P05,Q03',12,'2018-10-20');


CREATE TABLE THONGTINCHECK
(
	INFORMID NVARCHAR(20) NOT NULL,
	TRANGTHAI BIT,
	CONSTRAINT FK_IDINFORM FOREIGN KEY(INFORMID) REFERENCES THONGTIN(INFORMID)
	ON DELETE CASCADE
	ON UPDATE CASCADE
)

INSERT INTO THONGTINCHECK VALUES('09032020001','0'),
('09032020002','0'),
('09032020003','0'),
('09032020004','0'),
('09032020005','0'),
('09032020006','0');

CREATE TABLE TINHTRANGVUVIEC
(
	INFORMID NVARCHAR(20) NOT NULL,
	DANHAN BIT,
	HOANTHANH BIT,
	CONSTRAINT FK_TINHTANGVUVIEC FOREIGN KEY(INFORMID) REFERENCES THONGTIN(INFORMID)
	ON DELETE CASCADE
	ON UPDATE CASCADE
)

CREATE TABLE PHANCONG
(
	INFORMID NVARCHAR(20) NOT NULL,
	USERID NVARCHAR(20) NOT NULL,
	THONGBAO BIT,
	CONSTRAINT FK_PHANCONG FOREIGN KEY(INFORMID) REFERENCES THONGTIN(INFORMID),
	
	CONSTRAINT FK_PHANCONG1 FOREIGN KEY(USERID) REFERENCES USERS(USERID)
	ON DELETE CASCADE
	ON UPDATE CASCADE
)


